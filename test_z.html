<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>_z test</title>
    <script src="/_z.js"></script>
    <link rel="stylesheet" href="grid.css" />
    <style>body {font-family:sans-serif;margin:0}</style>
</head>
<body data-title="zdom test page" class="oldskool">
    <script>
        var frm = document.body.appendChild(_z.dom("div.container>div.row>section.col-md-6>h3^section one++section.col-md-6>h3^another section"));
        frm.lastChild.firstChild.appendChild(_z.dom("p;0", ["You can use the developer console to test _z.dom()"]));
        frm.lastChild.lastChild.appendChild(_z.dom("p.centered>a#downloadlink^href=#>h2^Document"));
        var dl = [{ "First Name": "Brian", "Last Name": "Brake", "Phone Number": "1234567" }, { "First Name": "Dave", "Last Name": "Hammer", "Phone Number": "2341567" }];

    var wb = _z.dom("ss:Workbook^xmlns:ss=urn:schemas-microsoft-com:office:spreadsheet>ss:Styles>ss:Style^ss:ID=1>ss:Font^ss:Bold=1+++ss:Worksheet^ss:Name=Sheet1>ss:Table>ss:Column^ss:Width=80*3");
    wb.lastChild.firstChild.appendChild(_z.dom("ss:Row^ss:StyleID=1>ss:Cell>ss:Data^ss:Type=String;0++ss:Cell>ss:Data^ss:Type=String;1++ss:Cell>ss:Data^ss:Type=String;2", Object.keys(dl[0])));
    dl.forEach(function (x) {
        var values = Object.keys(x).map(function (y) { return x[y] });
        wb.lastChild.firstChild.appendChild(_z.dom("ss:Row>ss:Cell>ss:Data^ss:Type=String;0++ss:Cell>ss:Data^ss:Type=String;1++ss:Cell>ss:Data^ss:Type=String;2", values));
    });

    var ser = new XMLSerializer();
    var str = '<?xml version="1.0" encoding="UTF-8" ?>\n' + ser.serializeToString(wb);
    str = str.replace(/ xmlns:ss="ss"/g, "");
    var blo = new Blob([str], { type: "text/xml;charset=utf-8" });
    downloadlink.href = URL.createObjectURL(blo);
    downloadlink.download = "Test.xml";
    </script>
</body>
</html>
